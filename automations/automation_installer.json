{"blocks":[{"id":"8930AAF5-070D-4BA5-8D48-6B2B23389032","type":"StartBlock","disabled":false,"name":"Start","displayName":"Start","comment":"","childId":"3FC3E0E0-9B18-483B-9E9B-35E9734F5644","inputs":[{"id":"run_mode","value":"manual","type":"select","structure":{}}],"settings":[],"collapsed":[{"name":"loop","isCollapsed":false}],"x":-491.42857142857133,"y":-3320.4285714285716},{"id":"3FC3E0E0-9B18-483B-9E9B-35E9734F5644","type":"ShowBlock","disabled":false,"name":"output","displayName":"Output","comment":"* This automation requires no configuration. Press \"Run\". *","childId":"85735C4A-DDD8-45EB-996A-922C08B04564","inputs":[{"id":"input","value":"#### Welcome to the Qlik Cloud Capacity installation process!\n\nThis installer handles both new installations and upgrades of the Qlik Cloud Monitoring applications.","type":"string","structure":[]}],"settings":[{"id":"display_mode","value":"add","type":"select","displayValue":"Add this output to the list of all outputs","structure":[]}],"collapsed":[{"name":"loop","isCollapsed":false}],"x":46,"y":46},{"id":"7C561465-C6CF-4733-A64A-60C036366220","type":"EndpointBlock","disabled":false,"name":"getCurrentUserId","displayName":"Qlik Cloud Services - Get Current User Id","comment":"Get the current user ID to look up whether they have the TenantAdmin role","childId":"725614B7-43E1-41AC-B926-AEBE211DB5D1","inputs":[],"settings":[{"id":"blendr_on_error","value":"stop","type":"select","structure":[]},{"id":"cache","value":"0","type":"select","structure":[]},{"id":"automations_censor_data","value":false,"type":"checkbox","structure":[]}],"collapsed":[{"name":"loop","isCollapsed":false}],"x":0,"y":240,"datasourcetype_guid":"61a87510-c7a3-11ea-95da-0fb0c241e75c","endpoint_guid":"6e9dbaa0-c7a4-11ea-9bd3-0da55b4cbed9","endpoint_role":"get"},{"id":"725614B7-43E1-41AC-B926-AEBE211DB5D1","type":"EndpointBlock","disabled":false,"name":"getUser","displayName":"Qlik Cloud Services - Get User","comment":"Look up whether they have the TenantAdmin role","childId":"47A45AEE-5BAD-4A62-9542-7C43616144E6","inputs":[{"id":"8eedf1d0-c7a5-11ea-9022-0fb2ce625902","value":"{$.getCurrentUserId}","type":"string","structure":[]}],"settings":[{"id":"blendr_on_error","value":"stop","type":"select","structure":[]},{"id":"cache","value":"0","type":"select","structure":[]},{"id":"automations_censor_data","value":false,"type":"checkbox","structure":[]}],"collapsed":[{"name":"loop","isCollapsed":false}],"x":-430,"y":262,"datasourcetype_guid":"61a87510-c7a3-11ea-95da-0fb0c241e75c","endpoint_guid":"7e670290-c7a5-11ea-9a9c-6dd2b282df86","endpoint_role":"get"},{"id":"47A45AEE-5BAD-4A62-9542-7C43616144E6","type":"IfElseBlock","disabled":false,"name":"condition5","displayName":"Condition 5","comment":"Is TenantAdmin assigned directly?","childId":"13D1270D-F223-4571-90B1-5C4FAB42782A","inputs":[{"id":"conditions","value":{"mode":"all","conditions":[{"input1":"{$.getUser.assignedRoles[*].name}","input2":"TenantAdmin","operator":"inList"}]},"type":"custom","structure":[]}],"settings":[],"collapsed":[{"name":"both","isCollapsed":false},{"name":"yes","isCollapsed":false},{"name":"no","isCollapsed":false}],"x":0,"y":600,"childTrueId":"EF5190ED-D2FC-429C-A702-818A69FF5415","childFalseId":"866A788C-084C-476E-B8B2-6BE9DC01ECB6"},{"id":"13D1270D-F223-4571-90B1-5C4FAB42782A","type":"IfElseBlock","disabled":false,"name":"condition7","displayName":"Condition 7","comment":"Whether TenantAdmin is assigned.","childId":"97D0BCAF-845E-4814-A9AB-1C3C93275FB0","inputs":[{"id":"conditions","value":{"mode":"all","conditions":[{"input1":"{$.userIsTenantAdmin}","input2":"1","operator":"="}]},"type":"custom","structure":[]}],"settings":[],"collapsed":[{"name":"both","isCollapsed":false},{"name":"yes","isCollapsed":true},{"name":"no","isCollapsed":false}],"x":656,"y":1086,"childTrueId":null,"childFalseId":"D123E5BB-537B-4BC8-B79F-30469FEFDFB1"},{"id":"97D0BCAF-845E-4814-A9AB-1C3C93275FB0","type":"SleepBlock","disabled":false,"name":"sleep12","displayName":"Sleep 12","comment":"","childId":"D16A2220-4C14-4819-A453-6C35D4F5CBCA","inputs":[{"id":"time","value":"1","type":"string","structure":[]}],"settings":[],"collapsed":[{"name":"loop","isCollapsed":false}],"x":347,"y":1970},{"id":"15C7E487-CE0F-41B5-BF00-10E426E7BE9D","type":"EndpointBlock","disabled":false,"name":"rawAPIRequest","displayName":"Qlik Cloud Services - Raw API Request","comment":"Check if API keys are enabled","childId":"FA5EBF19-6F95-4529-A5CD-EFD5139D81CE","inputs":[{"id":"4add8960-2078-11ec-be2c-7fc55d771fe6","value":"api-keys/configs/{$.getCurrentTenantInfo.id}","type":"string","structure":[]},{"id":"3b992a40-2072-11ec-9f0e-ed01586a7e1b","value":"3ba1eed0-2072-11ec-aa67-f118ee53373a","type":"select","displayValue":"GET","structure":[]},{"id":"3b8b9090-2072-11ec-8c77-5195fbb0ca65","value":null,"type":"object","mode":"keyValue","structure":[]},{"id":"993585d0-2839-11ec-b431-df4deed6c1ae","value":null,"type":"object","mode":"keyValue","structure":[]}],"settings":[{"id":"blendr_on_error","value":"stop","type":"select","structure":[]},{"id":"cache","value":"0","type":"select","structure":[]},{"id":"automations_censor_data","value":false,"type":"checkbox","structure":[]}],"collapsed":[{"name":"loop","isCollapsed":false}],"x":-429,"y":1776,"datasourcetype_guid":"61a87510-c7a3-11ea-95da-0fb0c241e75c","endpoint_guid":"3b75dd80-2072-11ec-9043-3b2aff6123af","endpoint_role":"get"},{"id":"FA5EBF19-6F95-4529-A5CD-EFD5139D81CE","type":"SleepBlock","disabled":false,"name":"sleep11","displayName":"Sleep 11","comment":"","childId":"C327E33A-1A34-4B0F-A235-7F73CF44A46D","inputs":[{"id":"time","value":"1","type":"string","structure":[]}],"settings":[],"collapsed":[{"name":"loop","isCollapsed":false}],"x":-343,"y":6722},{"id":"C327E33A-1A34-4B0F-A235-7F73CF44A46D","type":"IfElseBlock","disabled":false,"name":"condition11","displayName":"Condition 11","comment":"Are API keys enabled on the tenant?","childId":"C15616A6-60ED-4329-8F5A-5B0E78CFA437","inputs":[{"id":"conditions","value":{"mode":"all","conditions":[{"input1":"{$.rawAPIRequest.api_keys_enabled}","input2":"true","operator":"isTrue"}]},"type":"custom","structure":[]}],"settings":[],"collapsed":[{"name":"both","isCollapsed":false},{"name":"yes","isCollapsed":true},{"name":"no","isCollapsed":false}],"x":277,"y":7136,"childTrueId":null,"childFalseId":"83CEAE82-AE73-48DE-A89C-D12194F850F2"},{"id":"83CEAE82-AE73-48DE-A89C-D12194F850F2","type":"FormBlock","disabled":false,"name":"inputs10","displayName":"Inputs 10","comment":"Should this installer enable API keys on this tenant?","childId":"E1E5801E-E362-4D28-9225-A6660B6CD49D","inputs":[],"settings":[{"id":"persist_data","value":"no","type":"select","structure":[]},{"id":"automations_censor_data","value":false,"type":"checkbox","structure":[]}],"collapsed":[{"name":"loop","isCollapsed":false}],"x":120,"y":6420,"form":[{"id":"inputs10-input-0","type":"select","label":"Should this installer enable API keys on this tenant now?","order":0,"values":"Yes,No","options":[],"helpText":"API keys are not currently enabled on this tenant, which is a prerequisite of the installer. An API key is required to create the data connection to Qlik Cloud that the monitoring applications leverage. If 'No' is selected, this will need to be done manually, and the installer will exit.","isRequired":true}],"persistData":"no"},{"id":"E1E5801E-E362-4D28-9225-A6660B6CD49D","type":"IfElseBlock","disabled":false,"name":"condition12","displayName":"Condition 12","comment":"Yes","childId":null,"inputs":[{"id":"conditions","value":{"mode":"all","conditions":[{"input1":"{$.inputs10.'Should this installer enable API keys on this tenant now?'}","input2":"Yes","operator":"="}]},"type":"custom","structure":[]}],"settings":[],"collapsed":[{"name":"both","isCollapsed":false},{"name":"yes","isCollapsed":false},{"name":"no","isCollapsed":false}],"x":-422,"y":3961,"childTrueId":"639FC851-F7BB-4D8E-9E6F-9CE8834A5B0E","childFalseId":"9953B32A-C4D1-423D-9E5A-D71EC71014AF"},{"id":"639FC851-F7BB-4D8E-9E6F-9CE8834A5B0E","type":"FormBlock","disabled":false,"name":"inputs17","displayName":"Inputs 17","comment":"API key expiration.","childId":"439AA8F5-A834-43A3-828B-931CD959059F","inputs":[],"settings":[{"id":"persist_data","value":"no","type":"select","structure":[]},{"id":"automations_censor_data","value":false,"type":"checkbox","structure":[]}],"collapsed":[{"name":"loop","isCollapsed":false}],"x":-425,"y":5388,"form":[{"id":"inputs17-input-0","type":"select","label":"What should the maximum API key expiration be set to in days?","order":0,"values":"365,180,90,60,30,7","options":[],"helpText":"Note that the API key will need to be rotated for the data connection that the monitoring applications use within the timeframe that is set. This can be an automated process, but will need to be run within the window set above.","isRequired":true}],"persistData":"no"},{"id":"439AA8F5-A834-43A3-828B-931CD959059F","type":"EndpointBlock","disabled":false,"name":"rawAPIRequest4","displayName":"Qlik Cloud Services - Raw API Request 4","comment":"Enable API keys.","childId":"AB4F012F-69B7-4C0D-A529-8527A68D8034","inputs":[{"id":"4add8960-2078-11ec-be2c-7fc55d771fe6","value":"api-keys/configs/{$.getCurrentTenantInfo.id}","type":"string","structure":[]},{"id":"3b992a40-2072-11ec-9f0e-ed01586a7e1b","value":"3ba274f0-2072-11ec-a822-69fa394acb82","type":"select","displayValue":"PATCH","structure":[]},{"id":"3b8b9090-2072-11ec-8c77-5195fbb0ca65","value":"[{\"op\":\"replace\",\"path\":\"/api_keys_enabled\",\"value\":true}]","type":"object","mode":"raw","structure":[]},{"id":"993585d0-2839-11ec-b431-df4deed6c1ae","value":null,"type":"object","mode":"keyValue","structure":[]}],"settings":[{"id":"blendr_on_error","value":"stop","type":"select","structure":[]},{"id":"cache","value":"0","type":"select","structure":[]},{"id":"automations_censor_data","value":false,"type":"checkbox","structure":[]}],"collapsed":[{"name":"loop","isCollapsed":false}],"x":723,"y":6774,"datasourcetype_guid":"61a87510-c7a3-11ea-95da-0fb0c241e75c","endpoint_guid":"3b75dd80-2072-11ec-9043-3b2aff6123af","endpoint_role":"get"},{"id":"AB4F012F-69B7-4C0D-A529-8527A68D8034","type":"SleepBlock","disabled":false,"name":"sleep13","displayName":"Sleep 13","comment":"","childId":"37F837C6-03B4-4855-9416-7E478E048208","inputs":[{"id":"time","value":"2","type":"string","structure":[]}],"settings":[],"collapsed":[{"name":"loop","isCollapsed":false}],"x":-377,"y":7612},{"id":"37F837C6-03B4-4855-9416-7E478E048208","type":"VariableBlock","disabled":false,"name":"apiKeyExpiry","displayName":"Variable - apiKeyExpiry","comment":"Set the expiration of the API keys.","childId":"C058AC18-8AD9-4B3F-8086-483F89E295CD","inputs":[],"settings":[],"collapsed":[{"name":"loop","isCollapsed":false}],"x":240,"y":7100,"variableGuid":"6E4CA02F-F5DD-40E5-A0A0-781313451DEE","operations":[{"id":"set_value","key":"A28226D6-B650-4050-887C-2E49B64CE4DF","name":"Set value of { variable }","value":"P{$.inputs17.'What should the maximum API key expiration be set to in days?'}D"}]},{"id":"C058AC18-8AD9-4B3F-8086-483F89E295CD","type":"EndpointBlock","disabled":false,"name":"rawAPIRequest6","displayName":"Qlik Cloud Services - Raw API Request 6","comment":"Set expiry.","childId":null,"inputs":[{"id":"4add8960-2078-11ec-be2c-7fc55d771fe6","value":"api-keys/configs/{$.getCurrentTenantInfo.id}","type":"string","structure":[]},{"id":"3b992a40-2072-11ec-9f0e-ed01586a7e1b","value":"3ba274f0-2072-11ec-a822-69fa394acb82","type":"select","displayValue":"PATCH","structure":[]},{"id":"3b8b9090-2072-11ec-8c77-5195fbb0ca65","value":"[{\"op\":\"replace\",\"path\":\"/max_api_key_expiry\",\"value\":\"{$.apiKeyExpiry}\"}]","type":"object","mode":"raw","structure":[]},{"id":"993585d0-2839-11ec-b431-df4deed6c1ae","value":null,"type":"object","mode":"keyValue","structure":[]}],"settings":[{"id":"blendr_on_error","value":"stop","type":"select","structure":[]},{"id":"cache","value":"0","type":"select","structure":[]},{"id":"automations_censor_data","value":false,"type":"checkbox","structure":[]}],"collapsed":[{"name":"loop","isCollapsed":false}],"x":-372,"y":7642,"datasourcetype_guid":"61a87510-c7a3-11ea-95da-0fb0c241e75c","endpoint_guid":"3b75dd80-2072-11ec-9043-3b2aff6123af","endpoint_role":"get"},{"id":"9953B32A-C4D1-423D-9E5A-D71EC71014AF","type":"ShowBlock","disabled":false,"name":"output6","displayName":"Output 6","comment":"Prequisites not met","childId":"4844937D-D71C-4C68-B83C-7138F72F90FB","inputs":[{"id":"input","value":"{linebreak}\n##### A prerequisite has not been met\n\n| Prerequisite | Prerequisite Met |\n| --- | --- |\n| **API keys** are enabled on the tenant | ❌ |\n{linebreak}\n{linebreak}\nAPI keys being enabled is a prerequisite of the Qlik Cloud monitoring applications. Ensure that API keys are enabled on this tenant and then this installer can be run again. Existing the installer...","type":"string","structure":[]}],"settings":[{"id":"display_mode","value":"add","type":"select","structure":[]}],"collapsed":[{"name":"loop","isCollapsed":false}],"x":647,"y":6775},{"id":"4844937D-D71C-4C68-B83C-7138F72F90FB","type":"StopBlock","disabled":false,"name":"stop","displayName":"Stop","comment":"Stopping...","childId":null,"inputs":[],"settings":[],"collapsed":[{"name":"loop","isCollapsed":false}],"x":240,"y":7260},{"id":"D123E5BB-537B-4BC8-B79F-30469FEFDFB1","type":"ShowBlock","disabled":false,"name":"output10","displayName":"Output 10","comment":"Prequisites not met","childId":"2627CBD9-7885-45EA-B5EF-097C68CC42B2","inputs":[{"id":"input","value":"{linebreak}\n##### A prerequisite has not been met\n\n| Prerequisite | Prerequisite Met |\n| --- | --- |\n| User has the **TenantAdmin** role assigned | ❌ |\n{linebreak}\n{linebreak}\nThe executing user does not have the **TenantAdmin** role assigned, which is one of the prerequisites for the Qlik Cloud monitoring applications. Please try running this installer again once this role has been assigned. Exiting the installer...","type":"string","structure":[]}],"settings":[{"id":"display_mode","value":"add","type":"select","structure":[]}],"collapsed":[{"name":"loop","isCollapsed":false}],"x":120,"y":1380},{"id":"2627CBD9-7885-45EA-B5EF-097C68CC42B2","type":"StopBlock","disabled":false,"name":"stop2","displayName":"Stop 2","comment":"Stopping...","childId":null,"inputs":[],"settings":[],"collapsed":[{"name":"loop","isCollapsed":false}],"x":120,"y":1620},{"id":"866A788C-084C-476E-B8B2-6BE9DC01ECB6","type":"VariableBlock","disabled":false,"name":"userIsTenantAdmin","displayName":"Variable - userIsTenantAdmin","comment":"Yes","childId":"45A4533B-8FE4-4AFE-BDE7-7A16C304744C","inputs":[],"settings":[],"collapsed":[{"name":"loop","isCollapsed":false}],"x":172,"y":505,"variableGuid":"00F57F9D-35C5-43C2-ABBC-7E4BDF231FEB","operations":[{"id":"set_value","key":"CDCB85C8-FB0C-4605-BA99-8FB0FE00044E","name":"Set value of { variable }","value":"1"}]},{"id":"45A4533B-8FE4-4AFE-BDE7-7A16C304744C","type":"ForEachBlock","disabled":false,"name":"loop","displayName":"Loop","comment":"Is TenantAdmin inherited from a group?","childId":null,"inputs":[{"id":"input","value":"{$.getUser.assignedGroups}","type":"string","structure":[]}],"settings":[{"id":"automations_censor_data","value":false,"type":"checkbox","structure":[]}],"collapsed":[{"name":"loop","isCollapsed":false}],"x":0,"y":1000,"loopBlockId":"54835D6D-B5BF-48FB-89CD-13D16B28FAA8"},{"id":"54835D6D-B5BF-48FB-89CD-13D16B28FAA8","type":"IfElseBlock","disabled":false,"name":"condition6","displayName":"Condition 6","comment":"Does the assigned group contain TenantAdmin?","childId":null,"inputs":[{"id":"conditions","value":{"mode":"all","conditions":[{"input1":"{$.loop.item.assignedRoles[*].name}","input2":"TenantAdmin","operator":"inList"}]},"type":"custom","structure":[]}],"settings":[],"collapsed":[{"name":"both","isCollapsed":false},{"name":"yes","isCollapsed":false},{"name":"no","isCollapsed":true}],"x":-419,"y":919,"childTrueId":"D9991F74-32C9-49B6-91C7-8DCC2401CFF9","childFalseId":null},{"id":"D9991F74-32C9-49B6-91C7-8DCC2401CFF9","type":"VariableBlock","disabled":false,"name":"userIsTenantAdmin","displayName":"Variable - userIsTenantAdmin","comment":"Yes","childId":"A6169995-7770-4E9F-85A6-6E822D644539","inputs":[],"settings":[],"collapsed":[{"name":"loop","isCollapsed":false}],"x":370,"y":800,"variableGuid":"00F57F9D-35C5-43C2-ABBC-7E4BDF231FEB","operations":[{"id":"set_value","key":"CDCB85C8-FB0C-4605-BA99-8FB0FE00044E","name":"Set value of { variable }","value":"1"}]},{"id":"A6169995-7770-4E9F-85A6-6E822D644539","type":"ForEachBreakBlock","disabled":false,"name":"exitLoop","displayName":"Exit Loop","comment":"","childId":null,"inputs":[],"settings":[],"collapsed":[{"name":"loop","isCollapsed":false}],"x":-420,"y":1349},{"id":"D16A2220-4C14-4819-A453-6C35D4F5CBCA","type":"EndpointBlock","disabled":false,"name":"getCurrentTenantInfo","displayName":"Qlik Cloud Services - Get Current Tenant Info","comment":"","childId":"D8435DC7-9CBA-4B01-B690-C223733FA39E","inputs":[],"settings":[{"id":"blendr_on_error","value":"stop","type":"select","structure":[]},{"id":"cache","value":"0","type":"select","structure":[]},{"id":"automations_censor_data","value":false,"type":"checkbox","structure":[]}],"collapsed":[{"name":"loop","isCollapsed":false}],"x":-372,"y":735,"datasourcetype_guid":"61a87510-c7a3-11ea-95da-0fb0c241e75c","endpoint_guid":"55051480-cb86-11ec-b746-892c1d04114e","endpoint_role":"get"},{"id":"EF5190ED-D2FC-429C-A702-818A69FF5415","type":"VariableBlock","disabled":false,"name":"userIsTenantAdmin","displayName":"Variable - userIsTenantAdmin","comment":"Yes","childId":null,"inputs":[],"settings":[],"collapsed":[{"name":"loop","isCollapsed":false}],"x":768,"y":-205,"variableGuid":"00F57F9D-35C5-43C2-ABBC-7E4BDF231FEB","operations":[{"id":"set_value","key":"CDCB85C8-FB0C-4605-BA99-8FB0FE00044E","name":"Set value of { variable }","value":"1"}]},{"id":"3963944D-571A-403B-B4B9-A2454830221A","type":"EndpointBlock","disabled":false,"name":"listSpaces","displayName":"Qlik Cloud Services - List Spaces","comment":"Liste des espaces","childId":"9DB1E0A7-8434-4D29-989E-365ADD8540C3","inputs":[],"settings":[{"id":"maxitemcount","value":"","type":"string","structure":[]},{"id":"blendr_on_error","value":"stop","type":"select","structure":[]},{"id":"cache","value":"0","type":"select","structure":[]},{"id":"automations_censor_data","value":false,"type":"checkbox","structure":[]}],"collapsed":[{"name":"loop","isCollapsed":true}],"x":-372,"y":2615,"loopBlockId":null,"datasourcetype_guid":"61a87510-c7a3-11ea-95da-0fb0c241e75c","endpoint_guid":"42815920-5f18-11eb-8321-91b1587b6c06","endpoint_role":"list"},{"id":"96A77CE9-7DAC-4027-BAF4-0847131716B8","type":"FormBlock","disabled":false,"name":"inputs","displayName":"Inputs","comment":"","childId":"754CF49D-74E6-4E8D-9DE0-41CDB656EE55","inputs":[],"settings":[{"id":"persist_data","value":"no","type":"select","structure":[]},{"id":"automations_censor_data","value":false,"type":"checkbox","structure":[]}],"collapsed":[{"name":"loop","isCollapsed":false}],"x":-448,"y":3756,"form":[{"id":"inputs-input-0","type":"select","label":"Select a shared space","order":0,"values":"{ $.loop2 }","options":[],"helpText":"Select a share space where you want to import the Qlik Capacity Monitoring App","isRequired":true}],"persistData":"no"},{"id":"C15616A6-60ED-4329-8F5A-5B0E78CFA437","type":"CallUrlBlock","disabled":false,"name":"callURL","displayName":"Call URL","comment":"Getting OAuth Client Configured on Qlik Cloud Tenant","childId":"7BA6C4CA-69D7-423F-B48E-6A0209BCF918","inputs":[{"id":"url","value":"https://{$.getCurrentTenantInfo.hostnames[0]}/api/v1/oauth-clients","type":"string","structure":[]},{"id":"method","value":"GET","type":"select","displayValue":"GET","structure":[]},{"id":"timeout","value":"","type":"string","structure":[]},{"id":"params","value":null,"type":"object","mode":"keyValue","structure":[]},{"id":"headers","value":[{"key":"Authorization","value":"Bearer { $.inputs3.'### Please provide a valid Qlik API Key' }"}],"type":"object","mode":"keyValue","structure":[]},{"id":"encoding","value":"","type":"string","structure":[]}],"settings":[{"id":"blendr_on_error","value":"stop","type":"select","structure":[]},{"id":"full_response","value":null,"type":"checkbox","structure":[]},{"id":"capitalize_headers","value":true,"type":"checkbox","structure":[]},{"id":"automations_censor_data","value":false,"type":"checkbox","structure":[]}],"collapsed":[{"name":"loop","isCollapsed":false}],"x":-491.42857142857133,"y":579.5714285714284},{"id":"3F73F249-1B89-45E8-9F2E-453753DCF791","type":"IfElseBlock","disabled":false,"name":"condition","displayName":"Condition","comment":"If QlikOAuth2 doesn't exist, ask to create it","childId":"3963944D-571A-403B-B4B9-A2454830221A","inputs":[{"id":"conditions","value":{"mode":"all","conditions":[{"input1":"{ $.callURL.data[*].clientName }","input2":"QlikOAuth2","operator":"inList"}]},"type":"custom","structure":[]}],"settings":[],"collapsed":[{"name":"both","isCollapsed":false},{"name":"yes","isCollapsed":false},{"name":"no","isCollapsed":false}],"x":-752,"y":2363,"childTrueId":"40450019-A996-44CA-9494-DBE40574BCA4","childFalseId":"06002209-33B7-44EF-BC09-131EF51A7160"},{"id":"06002209-33B7-44EF-BC09-131EF51A7160","type":"ShowBlock","disabled":false,"name":"output2","displayName":"Output 2","comment":"Creating a new OAuth Client","childId":"AA6813ED-76D2-4A94-8DA0-7D98257AAED1","inputs":[{"id":"input","value":"{linebreak}\n##### A prerequisite has not been met\n| Prerequisite | Prerequisite Met |\n| --- | --- |\n| **OAuth Client** is not enabled on the tenant | ❌ |\n{linebreak}","type":"string","structure":[]}],"settings":[{"id":"display_mode","value":"add","type":"select","structure":[]}],"collapsed":[{"name":"loop","isCollapsed":false}],"x":-239,"y":1431},{"id":"3A7108F0-0C3B-4ACB-A298-844DA0D4068F","type":"CallUrlBlock","disabled":false,"name":"callURL2","displayName":"Call URL 2","comment":"Importing Qlik Application","childId":"1CD4BCFD-0B50-4BC4-B71D-B3F4B748C278","inputs":[{"id":"url","value":"https://github.com/tensor365/qlik-capacity-monitoring-app/raw/refs/heads/main/apps/Qlik%20Capacity%20Estimator.qvf","type":"string","structure":[]},{"id":"method","value":"GET","type":"select","structure":[]},{"id":"timeout","value":"","type":"string","structure":[]},{"id":"params","value":null,"type":"object","mode":"keyValue","structure":[]},{"id":"headers","value":null,"type":"object","mode":"keyValue","structure":[]},{"id":"encoding","value":"","type":"string","structure":[]}],"settings":[{"id":"blendr_on_error","value":"stop","type":"select","structure":[]},{"id":"full_response","value":null,"type":"checkbox","structure":[]},{"id":"capitalize_headers","value":true,"type":"checkbox","structure":[]},{"id":"automations_censor_data","value":false,"type":"checkbox","structure":[]}],"collapsed":[{"name":"loop","isCollapsed":false}],"x":-315,"y":4827},{"id":"1CD4BCFD-0B50-4BC4-B71D-B3F4B748C278","type":"VariableBlock","disabled":false,"name":"base64appQlik","displayName":"Variable - base64appQlik","comment":"Switching App into base64","childId":"96A95D6B-8BA8-4029-849B-B65CDEC1605E","inputs":[],"settings":[],"collapsed":[{"name":"loop","isCollapsed":false}],"x":-315,"y":4587,"variableGuid":"61D2B734-E77E-4236-B743-F384D933CE5D","operations":[{"id":"set_value","key":"212D1E06-016F-410B-BF77-119AA95E9A40","name":"Set value of { variable }","value":"{base64encode: { $.callURL2 }}"}]},{"id":"96A95D6B-8BA8-4029-849B-B65CDEC1605E","type":"EndpointBlock","disabled":false,"name":"importAppFromBase64EncodedFile","displayName":"Qlik Cloud Services - Import App From Base 64 Encoded File","comment":"Import Qlik Application","childId":"A482B856-B08D-4CC6-A710-87077182FA4D","inputs":[{"id":"09b520a0-7aa4-11eb-8143-cde65e595ead","value":"{ $.base64appQlik }","type":"string","structure":[]},{"id":"19661000-67b1-11eb-b4c6-fb30d89c586f","value":"Qlik Capacity Estimator","type":"string","structure":[]},{"id":"197675a0-67b1-11eb-b6f6-9ff3bc51ddbf","value":"{ $.inputs.'Select a shared space' }","type":"string","structure":[]},{"id":"4d3a3300-67b1-11eb-99af-3d55175faa9a","value":"5a406580-67b1-11eb-bad4-5f783555fa1b","type":"select","displayValue":"NEW","structure":[]},{"id":"ac4b58f0-67b1-11eb-8126-89d0cf328adb","value":null,"type":"string","structure":[]}],"settings":[{"id":"blendr_on_error","value":"stop","type":"select","structure":[]},{"id":"automations_censor_data","value":false,"type":"checkbox","structure":[]}],"collapsed":[{"name":"loop","isCollapsed":false}],"x":-372,"y":3215,"datasourcetype_guid":"61a87510-c7a3-11ea-95da-0fb0c241e75c","endpoint_guid":"194b9430-67b1-11eb-9e04-6dbde84bea83","endpoint_role":"create"},{"id":"9DB1E0A7-8434-4D29-989E-365ADD8540C3","type":"FilterListBlock","disabled":false,"name":"filterList","displayName":"Filter over Qlik Cloud Services - List Spaces - Filter List","comment":"","childId":"AF3DB768-8D00-41D7-957D-FC9C03340EF7","inputs":[{"id":"list","value":"{ $.listSpaces }","type":"string","structure":[]},{"id":"conditions","value":{"mode":"all","conditions":[{"input1":"type","input2":"shared","operator":"="}]},"type":"custom","structure":[]}],"settings":[{"id":"automations_censor_data","value":false,"type":"checkbox","structure":[]}],"collapsed":[{"name":"loop","isCollapsed":true}],"x":-372,"y":2975,"loopBlockId":null},{"id":"5EDC167B-28AC-4D0A-B2A2-16565257DB19","type":"VariableBlock","disabled":false,"name":"spaceListInput","displayName":"Variable - spaceListInput","comment":"","childId":"885D5C6C-5531-4197-ACDB-C62A3873DCCD","inputs":[],"settings":[],"collapsed":[{"name":"loop","isCollapsed":false}],"x":-359,"y":3231,"variableGuid":"F192A3AE-CDD3-4FD1-9F0F-D16660A87D50","operations":[{"id":"add_item","key":"E299CEF5-82CC-4CC5-99DA-7D86A7D44C52","name":"Add item to { variable }","value":"{ $.spaceList }"}]},{"id":"885D5C6C-5531-4197-ACDB-C62A3873DCCD","type":"ForEachBlock","disabled":false,"name":"loop2","displayName":"Loop 2","comment":"Looping on space ","childId":"96A77CE9-7DAC-4027-BAF4-0847131716B8","inputs":[{"id":"input","value":"{ $.filterList }","type":"string","structure":[]}],"settings":[{"id":"automations_censor_data","value":false,"type":"checkbox","structure":[]}],"collapsed":[{"name":"loop","isCollapsed":false}],"x":-359,"y":3351,"loopBlockId":"FFDB658F-B7D2-4DA3-B008-619994273466"},{"id":"FFDB658F-B7D2-4DA3-B008-619994273466","type":"VariableBlock","disabled":false,"name":"spaceList","displayName":"Variable - spaceList","comment":"","childId":"FA595FFA-4704-4AD5-B680-96FA061B8A2E","inputs":[],"settings":[],"collapsed":[{"name":"loop","isCollapsed":false}],"x":-656,"y":2677,"variableGuid":"B5758A39-0992-49AA-953C-A050E7B67AC2","operations":[{"id":"set_key_value","key":"E0FB9B67-BBD3-48C6-9A86-732DAE9A15F2","name":"Set key/values of { variable }","value":[{"key":"{ $.loop2.item.id }","value":"{ $.loop2.item.name }"}]}]},{"id":"FA595FFA-4704-4AD5-B680-96FA061B8A2E","type":"VariableBlock","disabled":false,"name":"spaceListInput","displayName":"Variable - spaceListInput","comment":"","childId":null,"inputs":[],"settings":[],"collapsed":[{"name":"loop","isCollapsed":false}],"x":-670,"y":2682,"variableGuid":"F192A3AE-CDD3-4FD1-9F0F-D16660A87D50","operations":[{"id":"add_item","key":"9FF2A505-611F-43A0-A4AB-11639B2E828E","name":"Add item to { variable }","value":"{ $.spaceList }"}]},{"id":"754CF49D-74E6-4E8D-9DE0-41CDB656EE55","type":"EndpointBlock","disabled":false,"name":"rawAPIRequest2","displayName":"Qlik Cloud Services - Raw API Request 2","comment":"Getting Data Connection List","childId":"21E40027-A7D4-46DC-A98D-690F4E55B06B","inputs":[{"id":"4add8960-2078-11ec-be2c-7fc55d771fe6","value":"data-connections","type":"string","structure":[]},{"id":"3b992a40-2072-11ec-9f0e-ed01586a7e1b","value":"3ba1eed0-2072-11ec-aa67-f118ee53373a","type":"select","displayValue":"GET","structure":[]},{"id":"3b8b9090-2072-11ec-8c77-5195fbb0ca65","value":null,"type":"object","mode":"keyValue","structure":[]},{"id":"993585d0-2839-11ec-b431-df4deed6c1ae","value":[{"key":"spaceId","value":"{ $.inputs.'Select a shared space' }"}],"type":"object","mode":"keyValue","structure":[]}],"settings":[{"id":"blendr_on_error","value":"stop","type":"select","structure":[]},{"id":"cache","value":"0","type":"select","structure":[]},{"id":"automations_censor_data","value":false,"type":"checkbox","structure":[]}],"collapsed":[{"name":"loop","isCollapsed":false}],"x":194,"y":3499,"datasourcetype_guid":"61a87510-c7a3-11ea-95da-0fb0c241e75c","endpoint_guid":"3b75dd80-2072-11ec-9043-3b2aff6123af","endpoint_role":"get"},{"id":"21E40027-A7D4-46DC-A98D-690F4E55B06B","type":"IfElseBlock","disabled":false,"name":"condition2","displayName":"Condition 2","comment":"Test si la connexion API QlikDataGetConnector existe","childId":"50F2ED12-D0A7-4747-B072-54A7E0C425BC","inputs":[{"id":"conditions","value":{"mode":"all","conditions":[{"input1":"{ $.rawAPIRequest2.data[*].qName }","input2":"QlikDataGetConnector","operator":"inList"}]},"type":"custom","structure":[]}],"settings":[],"collapsed":[{"name":"both","isCollapsed":false},{"name":"yes","isCollapsed":true},{"name":"no","isCollapsed":false}],"x":-372,"y":3835,"childTrueId":null,"childFalseId":"5FA48E18-A85E-4ABD-9A50-17A09655F083"},{"id":"50F2ED12-D0A7-4747-B072-54A7E0C425BC","type":"IfElseBlock","disabled":false,"name":"condition3","displayName":"Condition 3","comment":"Test si la connexion API QlikDataPostConnector existe","childId":"3A7108F0-0C3B-4ACB-A298-844DA0D4068F","inputs":[{"id":"conditions","value":{"mode":"all","conditions":[{"input1":"{ $.rawAPIRequest2.data[*].qName }","input2":"QlikDataPostConnector","operator":"inList"}]},"type":"custom","structure":[]}],"settings":[],"collapsed":[{"name":"both","isCollapsed":false},{"name":"yes","isCollapsed":true},{"name":"no","isCollapsed":false}],"x":-875,"y":3841,"childTrueId":null,"childFalseId":"47146080-AC1E-42AC-B549-71311C5AC51D"},{"id":"6A1D47A4-3352-4B78-928E-C4138F9FDB41","type":"EndpointBlock","disabled":false,"name":"rawAPIRequest3","displayName":"Qlik Cloud Services - Raw API Request 3","comment":"Création de la connexion QlikDataGetConnector ","childId":null,"inputs":[{"id":"4add8960-2078-11ec-be2c-7fc55d771fe6","value":"data-connections","type":"string","structure":[]},{"id":"3b992a40-2072-11ec-9f0e-ed01586a7e1b","value":"d8056ca0-2072-11ec-b110-cbae7b0a483b","type":"select","displayValue":"POST","structure":[]},{"id":"3b8b9090-2072-11ec-8c77-5195fbb0ca65","value":[{"key":"qLogOn","value":"1"},{"key":"qName","value":"QlikDataGetConnector"},{"key":"qType","value":"QvRestConnector.exe"},{"key":"qConnectStatement","value":"CUSTOM CONNECT TO \"provider=QvRestConnector.exe;url=https://{$.tenantURL}/api/v1/data-connections;timeout=30;readwritetimeout=300;method=GET;httpProtocol=1.1;isKeepAlive=true;bodyEncoding=UTF-8;sendExpect100Continue=true;autoDetectResponseType=true;checkResponseTypeOnTestConnection=true;keyGenerationStrategy=0;XMLDTD=0;authSchema=anonymous;serverCertificateValidation=UseTrust;checkCertificateRevocation=false;enableMutualSSL=false;addMissingQueryParametersToFinalRequest=false;queryHeaders=Authorization%2Bearer { $.inputs3.'### Please provide a valid Qlik API Key' };allowWithConnection=true;retryFailedRequest=false;PaginationType=None;allowResponseHeaders=false;allowHttpsOnly=false;\""},{"key":"datasourceID","value":"rest"},{"key":"space","value":"{ $.inputs.'Select a shared space' }"}],"type":"object","mode":"keyValue","structure":[]},{"id":"993585d0-2839-11ec-b431-df4deed6c1ae","value":null,"type":"object","mode":"keyValue","structure":[]}],"settings":[{"id":"blendr_on_error","value":"stop","type":"select","structure":[]},{"id":"cache","value":"0","type":"select","structure":[]},{"id":"automations_censor_data","value":false,"type":"checkbox","structure":[]}],"collapsed":[{"name":"loop","isCollapsed":false}],"x":-759,"y":3505,"datasourcetype_guid":"61a87510-c7a3-11ea-95da-0fb0c241e75c","endpoint_guid":"3b75dd80-2072-11ec-9043-3b2aff6123af","endpoint_role":"get"},{"id":"5BACF5D1-728C-4682-BC88-BC6ED598BFB1","type":"EndpointBlock","disabled":false,"name":"rawAPIRequest5","displayName":"Qlik Cloud Services - Raw API Request 5","comment":"Création de la connexion QlikDataPostConnector","childId":null,"inputs":[{"id":"4add8960-2078-11ec-be2c-7fc55d771fe6","value":"data-connections","type":"string","structure":[]},{"id":"3b992a40-2072-11ec-9f0e-ed01586a7e1b","value":"d8056ca0-2072-11ec-b110-cbae7b0a483b","type":"select","displayValue":"POST","structure":[]},{"id":"3b8b9090-2072-11ec-8c77-5195fbb0ca65","value":[{"key":"qLogOn","value":"1"},{"key":"qName","value":"QlikDataPostConnector"},{"key":"qType","value":"QvRestConnector.exe"},{"key":"qConnectStatement","value":"CUSTOM CONNECT TO \"provider=QvRestConnector.exe;url=https://{$.tenantURL}/oauth/token;timeout=30;readwritetimeout=300;method=POST;requestBody={\\n  %3scope%3: %3user_default offline_access%3,\\n  %3client_id%3: %XXXXXX%3,\\n  %3grant_type%3: %3client_credentials%3,\\n  %3client_secret%3: %XXXXX%3\\n};httpProtocol=1.1;isKeepAlive=true;bodyEncoding=UTF-8;sendExpect100Continue=false;autoDetectResponseType=true;checkResponseTypeOnTestConnection=true;keyGenerationStrategy=0;XMLDTD=0;authSchema=anonymous;serverCertificateValidation=UseTrust;checkCertificateRevocation=false;enableMutualSSL=false;addMissingQueryParametersToFinalRequest=false;queryHeaders=Content-Type%2application/json%1;allowWithConnection=true;retryFailedRequest=false;PaginationType=None;allowResponseHeaders=true;allowHttpsOnly=false;\""},{"key":"datasourceID","value":"rest"},{"key":"space","value":"{ $.inputs.'Select a shared space' }"}],"type":"object","mode":"keyValue","structure":[]},{"id":"993585d0-2839-11ec-b431-df4deed6c1ae","value":[],"type":"object","mode":"keyValue","structure":[]}],"settings":[{"id":"blendr_on_error","value":"stop","type":"select","structure":[]},{"id":"cache","value":"0","type":"select","structure":[]},{"id":"automations_censor_data","value":false,"type":"checkbox","structure":[]}],"collapsed":[{"name":"loop","isCollapsed":false}],"x":-239,"y":3411,"datasourcetype_guid":"61a87510-c7a3-11ea-95da-0fb0c241e75c","endpoint_guid":"3b75dd80-2072-11ec-9043-3b2aff6123af","endpoint_role":"get"},{"id":"D8435DC7-9CBA-4B01-B690-C223733FA39E","type":"VariableBlock","disabled":false,"name":"tenantURL","displayName":"Variable - tenantURL","comment":"Setup Tenant Id Qlik Cloud","childId":"15C7E487-CE0F-41B5-BF00-10E426E7BE9D","inputs":[],"settings":[],"collapsed":[{"name":"loop","isCollapsed":false}],"x":-749,"y":986,"variableGuid":"C56AE834-6BE4-461E-984D-58FDCCD34E62","operations":[{"id":"set_value","key":"F74983F4-4D2E-4DF1-BDF9-2AAB18F99904","name":"Set value of { variable }","value":"{ $.getCurrentTenantInfo.hostnames[0] }"}]},{"id":"5FA48E18-A85E-4ABD-9A50-17A09655F083","type":"ShowBlock","disabled":false,"name":"output3","displayName":"Output 3","comment":"Création de la connexion QlikDataGetConnector: Input Message","childId":"6A1D47A4-3352-4B78-928E-C4138F9FDB41","inputs":[{"id":"input","value":"🛈 QlikDataGetConnector does not exist. Creating QlikDataGetConnector.","type":"string","structure":[]}],"settings":[{"id":"display_mode","value":"add","type":"select","structure":[]}],"collapsed":[{"name":"loop","isCollapsed":false}],"x":-818,"y":3752},{"id":"47146080-AC1E-42AC-B549-71311C5AC51D","type":"ShowBlock","disabled":false,"name":"output4","displayName":"Output 4","comment":"Création de la connexion QlikDataPostConnector: Input Message","childId":"5BACF5D1-728C-4682-BC88-BC6ED598BFB1","inputs":[{"id":"input","value":"🛈  QlikDataPostConnector does not exist. Creating QlikDataPostConnector.","type":"string","structure":[]}],"settings":[{"id":"display_mode","value":"add","type":"select","structure":[]}],"collapsed":[{"name":"loop","isCollapsed":false}],"x":-878,"y":4060},{"id":"3231E0A8-C80A-487D-B105-52C069DA7CE1","type":"FormBlock","disabled":false,"name":"inputs2","displayName":"Inputs 2","comment":"","childId":"BC1E5763-40F2-4905-9074-9D946707048E","inputs":[],"settings":[{"id":"persist_data","value":"no","type":"select","structure":[]},{"id":"automations_censor_data","value":false,"type":"checkbox","structure":[]}],"collapsed":[{"name":"loop","isCollapsed":false}],"x":-692,"y":2110,"form":[{"id":"inputs2-input-0","type":"button","label":"Create an OAuth Authentification","order":0,"values":null,"options":[],"helpText":"Application need to use an OAuth configuration. By refusing the creation, the application won't be install.","isRequired":true}],"persistData":"no"},{"id":"BC1E5763-40F2-4905-9074-9D946707048E","type":"CallUrlBlock","disabled":false,"name":"callURL3","displayName":"Call URL 3","comment":"Creating an OAuth application QlikOAuth2","childId":"7D8DF1A9-A09E-4969-957C-555D076BD824","inputs":[{"id":"url","value":"https://{ $.tenantURL }/api/v1/oauth-clients","type":"string","structure":[]},{"id":"method","value":"POST","type":"select","displayValue":"POST","structure":[]},{"id":"timeout","value":"","type":"string","structure":[]},{"id":"params","value":"{ \"appType\": \"web\",\n  \"clientName\": \"QlikOAuth211\",\n  \"allowedGrantTypes\": [\"urn:qlik:oauth:user-impersonation\",               \"client_credentials\"],\n \"allowedOrigins\": [\"https://{$.tenantURL}\"]}","type":"object","mode":"raw","structure":[]},{"id":"headers","value":[{"key":"Authorization","value":"Bearer { $.inputs3.'### Please provide a valid Qlik API Key' }"}],"type":"object","mode":"keyValue","structure":[]},{"id":"encoding","value":"","type":"string","structure":[]}],"settings":[{"id":"blendr_on_error","value":"stop","type":"select","structure":[]},{"id":"full_response","value":null,"type":"checkbox","structure":[]},{"id":"capitalize_headers","value":true,"type":"checkbox","structure":[]},{"id":"automations_censor_data","value":false,"type":"checkbox","structure":[]}],"collapsed":[{"name":"loop","isCollapsed":false}],"x":-760,"y":2146},{"id":"AA6813ED-76D2-4A94-8DA0-7D98257AAED1","type":"SleepBlock","disabled":false,"name":"sleep","displayName":"Sleep","comment":"","childId":"3231E0A8-C80A-487D-B105-52C069DA7CE1","inputs":[{"id":"time","value":"1","type":"string","structure":[]}],"settings":[],"collapsed":[{"name":"loop","isCollapsed":false}],"x":-765,"y":2389},{"id":"CABDBBAA-E120-4873-8D5E-7D1D846FF11A","type":"ShowBlock","disabled":false,"name":"output5","displayName":"Output 5","comment":"","childId":null,"inputs":[{"id":"input","value":"| 🎉 **Success!** 🎉 | Installation/update complete. The application has been installed successfully |","type":"string","structure":[]}],"settings":[{"id":"display_mode","value":"add","type":"select","structure":[]}],"collapsed":[{"name":"loop","isCollapsed":false}],"x":-410,"y":5781},{"id":"7D8DF1A9-A09E-4969-957C-555D076BD824","type":"VariableBlock","disabled":false,"name":"clientId","displayName":"Variable - clientId","comment":"Setting clientId","childId":"3351A0CF-E2BB-4CA0-9AB0-D38D1A719B02","inputs":[],"settings":[],"collapsed":[{"name":"loop","isCollapsed":false}],"x":-970,"y":1685,"variableGuid":"E846E2EA-45F2-44A8-BE28-1E9616969EEE","operations":[{"id":"set_value","key":"4625B556-E881-4A6A-8429-3254FB523DD2","name":"Set value of { variable }","value":"{ $.callURL3.clientId }"}]},{"id":"3351A0CF-E2BB-4CA0-9AB0-D38D1A719B02","type":"VariableBlock","disabled":false,"name":"clientSecret","displayName":"Variable - clientSecret","comment":"Setting clientSecret","childId":"B9A2FFDF-A9C6-4773-A305-C3878F792E92","inputs":[],"settings":[],"collapsed":[{"name":"loop","isCollapsed":false}],"x":-964,"y":1676,"variableGuid":"62F89910-BAF1-4A29-8CBD-1449B0A1627F","operations":[{"id":"set_value","key":"9D3BEBB7-9D19-4CA4-AC42-54F899215385","name":"Set value of { variable }","value":"{ $.callURL3.clientSecret }"}]},{"id":"9B45703C-A9AE-4200-878A-7337F1A65320","type":"CallUrlBlock","disabled":false,"name":"callURL4","displayName":"Call URL 4","comment":"Updating secret an OAuth application QlikOAuth2","childId":"EAAAE827-8631-4D93-8E41-218E1ECF6330","inputs":[{"id":"url","value":"https://{$.tenantURL}/api/v1/oauth-clients//client-secrets","type":"string","structure":[]},{"id":"method","value":"POST","type":"select","displayValue":"POST","structure":[]},{"id":"timeout","value":"","type":"string","structure":[]},{"id":"params","value":null,"type":"object","mode":"raw","structure":[]},{"id":"headers","value":[{"key":"Authorization","value":"Bearer { $.inputs3.'### Please provide a valid Qlik API Key' }"}],"type":"object","mode":"keyValue","structure":[]},{"id":"encoding","value":"","type":"string","structure":[]}],"settings":[{"id":"blendr_on_error","value":"stop","type":"select","structure":[]},{"id":"full_response","value":null,"type":"checkbox","structure":[]},{"id":"capitalize_headers","value":true,"type":"checkbox","structure":[]},{"id":"automations_censor_data","value":false,"type":"checkbox","structure":[]}],"collapsed":[{"name":"loop","isCollapsed":false}],"x":-10,"y":1293},{"id":"B9A2FFDF-A9C6-4773-A305-C3878F792E92","type":"CallUrlBlock","disabled":false,"name":"callURL5","displayName":"Call URL 5","comment":"","childId":null,"inputs":[{"id":"url","value":"https://{$.tenantURL}/api/v1/oauth-clients/{ $.clientId }/connection-configs/me","type":"string","structure":[]},{"id":"method","value":"PATCH","type":"select","displayValue":"PATCH","structure":[]},{"id":"timeout","value":"","type":"string","structure":[]},{"id":"params","value":"[{\n  \"op\": \"replace\",\n  \"path\": \"/consentMethod\",\n  \"value\": \"trusted\"\n}]","type":"object","mode":"raw","structure":[]},{"id":"headers","value":[{"key":"Authorization","value":"Bearer { $.inputs3.'### Please provide a valid Qlik API Key' }"}],"type":"object","mode":"keyValue","structure":[]},{"id":"encoding","value":"","type":"string","structure":[]}],"settings":[{"id":"blendr_on_error","value":"stop","type":"select","structure":[]},{"id":"full_response","value":null,"type":"checkbox","structure":[]},{"id":"capitalize_headers","value":true,"type":"checkbox","structure":[]},{"id":"automations_censor_data","value":false,"type":"checkbox","structure":[]}],"collapsed":[{"name":"loop","isCollapsed":false}],"x":-983,"y":1881},{"id":"7BA6C4CA-69D7-423F-B48E-6A0209BCF918","type":"VariableBlock","disabled":false,"name":"clientSecret","displayName":"Variable - clientSecret","comment":"","childId":"3F73F249-1B89-45E8-9F2E-453753DCF791","inputs":[],"settings":[],"collapsed":[{"name":"loop","isCollapsed":false}],"x":-1029,"y":1546,"variableGuid":"62F89910-BAF1-4A29-8CBD-1449B0A1627F","operations":[{"id":"empty","key":"1EDEDEE2-BE71-4B28-A736-E478A941943B","name":"Empty { variable }","value":null}]},{"id":"610C6660-CFA5-4987-873E-DF0D34BEF9CB","type":"VariableBlock","disabled":false,"name":"clientId","displayName":"Variable - clientId","comment":"","childId":"9B45703C-A9AE-4200-878A-7337F1A65320","inputs":[],"settings":[],"collapsed":[{"name":"loop","isCollapsed":false}],"x":-939,"y":1529,"variableGuid":"E846E2EA-45F2-44A8-BE28-1E9616969EEE","operations":[{"id":"set_value","key":"C015E5CD-FF3A-4C5F-A1DC-607D8EE5A434","name":"Set value of { variable }","value":null}]},{"id":"40450019-A996-44CA-9494-DBE40574BCA4","type":"LookupItemBlock","disabled":false,"name":"lookupItemInList","displayName":"Lookup Item In List","comment":"","childId":"610C6660-CFA5-4987-873E-DF0D34BEF9CB","inputs":[{"id":"list","value":"{ $.callURL.data }","type":"string","structure":[]},{"id":"conditions","value":{"mode":"all","conditions":[{"input1":null,"input2":null,"operator":null}]},"type":"custom","structure":[]}],"settings":[{"id":"automations_censor_data","value":false,"type":"checkbox","structure":[]}],"collapsed":[],"x":-883,"y":1415},{"id":"A482B856-B08D-4CC6-A710-87077182FA4D","type":"SnippetBlock","disabled":false,"name":"GetLoadScript","displayName":"Qlik Cloud Services - Get Load Script","comment":"Getting the load script from Qlik Application","childId":"48B6EEF5-416B-4704-B3D0-81084B31DC2B","inputs":[{"id":"299dd6e0-7535-11eb-a1b1-8108a69d86b2","value":"{ $.importAppFromBase64EncodedFile.attributes.id }","type":"string","structure":[]}],"settings":[{"id":"blendr_on_error","value":"stop","type":"select","structure":[]},{"id":"automations_censor_data","value":false,"type":"checkbox","structure":[]}],"collapsed":[{"name":"loop","isCollapsed":false}],"x":-931,"y":4513,"datasourcetype_guid":"61a87510-c7a3-11ea-95da-0fb0c241e75c","snippet_guid":"8d2f7da0-5028-11eb-8889-317a6c8ea7fc"},{"id":"EAAAE827-8631-4D93-8E41-218E1ECF6330","type":"VariableBlock","disabled":false,"name":"clientSecret","displayName":"Variable - clientSecret","comment":"","childId":null,"inputs":[],"settings":[],"collapsed":[{"name":"loop","isCollapsed":false}],"x":-934,"y":1676,"variableGuid":"62F89910-BAF1-4A29-8CBD-1449B0A1627F","operations":[{"id":"set_value","key":"7190EF3E-C3A2-45A7-BF55-C85057F19E49","name":"Set value of { variable }","value":null}]},{"id":"94D237E3-F174-403F-AFCC-4C1D61FDA6F3","type":"VariableBlock","disabled":false,"name":"qlikScript","displayName":"Variable - qlikScript","comment":"Setting variable client id ","childId":"3C602902-E95E-4E60-ADB6-217CF96BD0B9","inputs":[],"settings":[],"collapsed":[{"name":"loop","isCollapsed":false}],"x":195,"y":5428,"variableGuid":"7CC5487A-2372-40BB-95EA-DA135DD2E8A3","operations":[{"id":"set_value","key":"AA59B300-4E16-4661-B804-B2DD9984171B","name":"Set value of { variable }","value":"{ replace: {$.qlikScript}, '<clientId>', $.clientId }"}]},{"id":"3C602902-E95E-4E60-ADB6-217CF96BD0B9","type":"VariableBlock","disabled":false,"name":"qlikScript","displayName":"Variable - qlikScript","comment":"Setting variable client secret","childId":"E0FCF2F5-28CF-4562-B7B5-FC3A63F37180","inputs":[],"settings":[],"collapsed":[{"name":"loop","isCollapsed":false}],"x":291,"y":4928,"variableGuid":"7CC5487A-2372-40BB-95EA-DA135DD2E8A3","operations":[{"id":"set_value","key":"AA59B300-4E16-4661-B804-B2DD9984171B","name":"Set value of { variable }","value":"{ replace: {$.qlikScript}, '<clientSecret>', $.clientSecret }"}]},{"id":"48B6EEF5-416B-4704-B3D0-81084B31DC2B","type":"VariableBlock","disabled":false,"name":"qlikScript","displayName":"Variable - qlikScript","comment":"Setting variable tenant URI","childId":"A9CF223A-4FCA-489E-9D62-71CA4D58D442","inputs":[],"settings":[],"collapsed":[{"name":"loop","isCollapsed":false}],"x":-359,"y":5291,"variableGuid":"7CC5487A-2372-40BB-95EA-DA135DD2E8A3","operations":[{"id":"set_value","key":"AA59B300-4E16-4661-B804-B2DD9984171B","name":"Set value of { variable }","value":"{replace: { replace: { $.GetLoadScript }, '<clientId>', '<clientId>' }, '<tenantURI>', $.tenantURL}"}]},{"id":"A9CF223A-4FCA-489E-9D62-71CA4D58D442","type":"VariableBlock","disabled":false,"name":"qlikScript","displayName":"Variable - qlikScript","comment":"Setting variable APIKey","childId":"94D237E3-F174-403F-AFCC-4C1D61FDA6F3","inputs":[],"settings":[],"collapsed":[{"name":"loop","isCollapsed":false}],"x":242,"y":5099,"variableGuid":"7CC5487A-2372-40BB-95EA-DA135DD2E8A3","operations":[{"id":"set_value","key":"AA59B300-4E16-4661-B804-B2DD9984171B","name":"Set value of { variable }","value":"{ replace: { $.qlikScript }, '<qlikApiKey>', '<qlikApiKey>' }"}]},{"id":"E0FCF2F5-28CF-4562-B7B5-FC3A63F37180","type":"EndpointBlock","disabled":false,"name":"setLoadScript","displayName":"Qlik Cloud Services - Set Load Script","comment":"","childId":"CABDBBAA-E120-4873-8D5E-7D1D846FF11A","inputs":[{"id":"917b8660-a12b-11ed-873f-fd156b9f0ebb","value":"{ $.importAppFromBase64EncodedFile.attributes.id }","type":"string","structure":[]},{"id":"d31e0400-a12c-11ed-b43b-29c58fb1f869","value":"{ $.qlikScript }","type":"string","structure":[]},{"id":"0da08560-a12d-11ed-92bf-6146d9e01e80","value":"Setting authentication details","type":"string","structure":[]}],"settings":[{"id":"blendr_on_error","value":"stop","type":"select","structure":[]},{"id":"automations_censor_data","value":false,"type":"checkbox","structure":[]}],"collapsed":[{"name":"loop","isCollapsed":false}],"x":-931,"y":5063,"datasourcetype_guid":"61a87510-c7a3-11ea-95da-0fb0c241e75c","endpoint_guid":"916661a0-a12b-11ed-882f-fb01a4e99b0a","endpoint_role":"create"},{"id":"AF3DB768-8D00-41D7-957D-FC9C03340EF7","type":"VariableBlock","disabled":false,"name":"spaceList","displayName":"Variable - spaceList","comment":"","childId":"5EDC167B-28AC-4D0A-B2A2-16565257DB19","inputs":[],"settings":[],"collapsed":[{"name":"loop","isCollapsed":false}],"x":-934,"y":3386,"variableGuid":"B5758A39-0992-49AA-953C-A050E7B67AC2","operations":[{"id":"set_key_value","key":"5D220CEA-5E89-4D3A-B425-21A3807ABAEB","name":"Set key/values of { variable }","value":"{  \"\": \"Personal\"}"}]},{"id":"F5FA939A-97C4-466B-91C2-22D8522C5924","type":"FormBlock","disabled":false,"name":"inputs3","displayName":"Inputs 3","comment":"API Key","childId":"7C561465-C6CF-4733-A64A-60C036366220","inputs":[],"settings":[{"id":"persist_data","value":"no","type":"select","displayValue":"No","structure":{}},{"id":"automations_censor_data","value":false,"type":"checkbox","structure":{}}],"collapsed":[{"name":"loop","isCollapsed":false}],"x":-491.42857142857133,"y":-3080.4285714285716,"form":[{"id":"inputs3-input-0","label":"Please provide a valid Qlik API Key","helpText":"API Key will be used inside the installer and inside the capacity monitoring app. You can follow this video to create an API Key: https://www.youtube.com/watch?v=xMBR_JrsSfI","type":"textarea","values":null,"isRequired":true,"options":{},"order":0}],"persistData":"no"},{"id":"85735C4A-DDD8-45EB-996A-922C08B04564","type":"SleepBlock","disabled":false,"name":"sleep2","displayName":"Sleep 2","comment":"","childId":"F5FA939A-97C4-466B-91C2-22D8522C5924","inputs":[{"id":"time","value":"2","type":"string","structure":{}}],"settings":[],"collapsed":[{"name":"loop","isCollapsed":false}],"x":-1094.2857142857142,"y":-2989}],"variables":[{"guid":"6E4CA02F-F5DD-40E5-A0A0-781313451DEE","name":"apiKeyExpiry","type":"string"},{"guid":"00F57F9D-35C5-43C2-ABBC-7E4BDF231FEB","name":"userIsTenantAdmin","type":"number"},{"guid":"61D2B734-E77E-4236-B743-F384D933CE5D","name":"base64appQlik","type":"string"},{"guid":"F192A3AE-CDD3-4FD1-9F0F-D16660A87D50","name":"spaceListInput","type":"list"},{"guid":"B5758A39-0992-49AA-953C-A050E7B67AC2","name":"spaceList","type":"object"},{"guid":"C56AE834-6BE4-461E-984D-58FDCCD34E62","name":"tenantURL","type":"string"},{"guid":"62F89910-BAF1-4A29-8CBD-1449B0A1627F","name":"clientSecret","type":"string"},{"guid":"E846E2EA-45F2-44A8-BE28-1E9616969EEE","name":"clientId","type":"string"},{"guid":"7CC5487A-2372-40BB-95EA-DA135DD2E8A3","name":"qlikScript","type":"string"}]}